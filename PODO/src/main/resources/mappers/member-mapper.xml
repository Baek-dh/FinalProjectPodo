<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">

	<resultMap type="member" id="member_rm">
	
	<id property="memberNo" 			column="MEMBER_NO"/>
	<result property="memberId" 		column="MEMBER_ID"/>
	<result property="memberPw" 		column="MEMBER_PW"/>
	<result property="memberNickname" 	column="MEMBER_NICK"/>
	<result property="memberName"		column="MEMBER_NM"/>
	<result property="memberTel" 		column="MEMBER_TEL"/>
	<result property="secessionFlag" 	column="SECESSION_FL"/>
	<result property="memberProfile" 	column="MEMBER_PROFILE"/>
	<result property="memberGrape" 		column="MEMBER_GRAPE"/>
	<result property="memberAddress" 	column="MEMBER_ADDR"/>
	<result property="memberTown" 		column="MEMBER_TOWN"/>
	<result property="createDate" 		column="CREATE_DT"/>
	<result property="admin"  			column="ADMIN" />
	<result property="shopInfo"  			column="SHOP_INFO" />
	
	</resultMap>

	<!-- 로그인 -->
	<select id="login" parameterType="member" resultMap="member_rm">
		SELECT MEMBER_NO, MEMBER_ID, MEMBER_NICK, MEMBER_TEL, 
			SECESSION_FL, MEMBER_PROFILE, MEMBER_GRAPE, MEMBER_ADDR, 
			TO_CHAR( CREATE_DT, 'YYYY-MM-DD HH24:MI:SS' ) AS CREATE_DT, MEMBER_TOWN, MEMBER_PW, ADMIN
		FROM MEMBER
		WHERE MEMBER_ID = #{memberId}
		AND SECESSION_FL = 'N'	
	</select>
	
	
	<!-- 회원가입 -->
	<insert id="signUp" parameterType="member">
		INSERT INTO MEMBER 
		VALUES(SEQ_MEMBER_NO.NEXTVAL, #{memberId}, #{memberPw}, #{memberNickname}, #{memberTel}, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, #{memberAddress}, DEFAULT, DEFAULT, #{memberName})
	</insert>
	
	
	<!-- 네이버 회원가입 -->
	<insert id="naverSignUp" parameterType="member">
		INSERT INTO MEMBER 
		VALUES(SEQ_MEMBER_NO.NEXTVAL, #{memberId}, 'xxxx', #{memberId}, 01011111111, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, 'aaa', DEFAULT)
	</insert>
	
	
	<!-- 아이디 중복체크 -->
	<select id="idDupCheck" parameterType="string" resultType="_int">
		SELECT COUNT(*) FROM MEMBER
		WHERE MEMBER_ID = #{memberId}
		AND SECESSION_FL = 'N'
	</select>
	
	
  	<!-- 닉네임 중복 체크 -->
  	<select id="nicknameDupCheck" parameterType="string" resultType="_int">
  		SELECT COUNT(*) FROM MEMBER
		WHERE MEMBER_NICK = #{memberNickname}
		AND SECESSION_FL = 'N'
  	</select>
  	
  	<!-- 아이디 찾기 -->
  	<select id="findId" parameterType="member" resultMap="member_rm">
  		SELECT MEMBER_ID, CREATE_DT 
  		FROM MEMBER
  		WHERE MEMBER_NM = #{memberName}
  		<!-- AND MEMBER_TEL = #{memberTel} -->
  		AND SECESSION_FL ='N'
  	</select>
  	
  	<!-- 비밀번호 찾기 -->
  	<select id="findPw" parameterType="member" resultType="_int">
  		SELECT COUNT(*) FROM MEMBER
  		WHERE MEMBER_ID = #{memberId}
  		AND MEMBER_NM  = #{memberName}
  		<!-- AND MEMBER_TEL = #{memberTel} -->
  		AND SECESSION_FL ='N'
  	</select>
  	
</mapper>
