<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="myShopMapper">

	<resultMap type="itemBoard" id="itemBoard_rm">
		<id property="boardNo" column="BOARD_NO"/>
		
		<result property="boardTitle" 		column="BOARD_TITLE"/>
		<result property="boardContent" 	column="BOARD_CONTENT"/>
		<result property="readCount" 		column="READ_COUNT"/>
		<result property="createDate" 	column="CREATE_DT"/>
		<result property="updateDate" 	column="UPDATE_DT"/>
		<result property="itemCondition" 		column="ITEM_CONDITION"/>
		<result property="tradeCondition" 	column="TRADE_CONDITION"/>
		<result property="delivery" 	column="DELIVERY"/>
		<result property="price" 	column="PRICE"/>
		<result property="secessionFlag" 	column="SECESSION_FL"/>
		<result property="sellArea" 	column="SELL_AREA"/>
		<result property="boardCode" 	column="BOARD_CD"/>
		<result property="memberNo" 	column="MEMBER_NO"/>
		<result property="categoryNo" 	column="CATEGORY_NO"/>
		<result property="buyMemberNo" 	column="BUY_MEMBER_NO"/>
	</resultMap>
	
	<resultMap type="review" id="review_rm">
		<id property="reviewNo" column="REVIEW_NO" />
		
		<result property="reviewContent" column="REVIEW_CONTENT" />
		<result property="reviewCondition" column="REVIEW_CONDITION" />
		<result property="secessionFlag" column="SECESSION_FL" />
		<result property="memberNo" column="MEMBER_NO" />
		<result property="boardNo" column="BOARD_NO" />
		<result property="createDate" column="CREATE_DT" />
	</resultMap>
  
  <select id="selectMemberShop" resultMap="itemBoard_rm">
      SELECT BOARD_NO, BOARD_CONTENT, PRICE, 
          CASE WHEN SYSDATE - CREATE_DT &lt; 1
	          THEN TO_CHAR(CREATE_DT, 'HH:MI')
	          ELSE TO_CHAR(CREATE_DT, 'YYYY-MM-DD')
	      END CREATE_DT
	   FROM ITEM_BOARD
	   WHERE MEMBER_NO = ${memberNo}
	   AND SECESSION_FL = 'N'
	   ORDER BY BOARD_NO
  </select>
  
  <select id="selectMemberReview">
      SELECT REVIEW_NO, REVIEW_CONTENT, MEMBER_NICK, BOARD_TITLE
      FROM REVIEW
      JOIN MEMBER USING(MEMBER_NO)
      JOIN ITEM_BOARD USING(MEMBER_NO)
      WHERE MEMBER_NO = ${memberNo}
  </select>
  
</mapper>
